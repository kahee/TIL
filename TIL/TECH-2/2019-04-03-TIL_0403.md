---
title: "TIL - 0403"
date: 2019-04-03 00:00:00
img:
categories:
- TIL, Network
---

## Firewall and IDS:IPS

1. Firewall
- 방화벽이란 불법적으로 침입하는 패킷들을 막는 것
- 패킷들의 헤더정보를 가지고 동작
- ex) source address, protocol type
- "처리속도는 빠르나, 보내는쪽에서 source 주소를 바꿔서 보내는 것 같은 상황에서 찾아낼 수 없는 한계"
- 목표 : 조건에 만족하는 패킷만 통과시키고 그외는 드럽

2. IDS(Intrusion Detection System) / IPS(Intrusion Protection System)
- 방화벽 뒤에서 동작하는 것
- 방화벽에서는 단순한 규칙, 프로토콜 타입과 같은 헤더 정보를 통해 해킹 공격을 1차적으로 검증
- 1차적으로 찾을수없는 공격들 (패킷들) 기억하고 파악해서 검사하는 기술들
- 페이로드 정보까지 읽어냄 , 연속적인 패킷
- IDS 자신이 차단하는 것이 아니라 경보메시지를 관리자에게 전달
- IPS 스스로 커넥션을 끊어버린다거나 패킷을 스스로 차단시켜 버리는 것

3. stateless packet filter
- 패킷 단위로 보는 것
- source 주소, destination 주소, 포트 넘버
- Access control 리스트를 기반으로 판단
    - TCP 연결을 위해 3 way handshake 로 연결 -> ACK 가 1인 것만 연결 : 자신 내부 네트워크에서 보낸 요청에서만 통과하겠다는 의미
    - 53 : DNS
    - 80 : 서버
- 문제
    - 외부에서 80번 포트에서 오는 것 ACK 비트 1이면 다 받아들이는데, 공격자가 이런 패킷을 임의로 만들어서 보내는 경우
    - 실제 TCP 연결이 없음에도 불구하고 위에 같은 패킷을 보내서 방화벽을 통과하게 됨
    - denial of service 공격에 무방비

4. Stateful packet filter
- 실제로 패킷이 존재하는지에 대해 판단
- SYN , FIN 플래그를 통해 판단
- Connection table 을 통해서 실제로 유효한 커넥션이 있는지 검사하고 통과

5. Application Gateways
- 특정한 응용 서비스를 , 특정 사람들에게만 허용
- 개별적으로 애플리케이션 게이트웨이를 만들고 라우터에게 그 게이트ㅞ이를 통과하지 않은 트래픽은 통과시키지 말라고함
- 예
    - 네트워크 관리자가 몇몇 사용자들에대해서만 외부로 텔넷을 하는 것을 허용하게 하고 싶음
    - 두개의 TCP 연결이 되고 이 중간에서 포워딩

6. IDS/IPS
- 헤더 정보만 보는 것이 아니라, 이것이 담은 페이로드 정보도 파악 ex) 바이러스,
- 여러개가 계속해서 공격이 아니고서는 이상하다고 파악할 수 있음
- 이상한 순서들의 패킷도 파악

7. IDS
- 한 네트워크 내에 여러군데에 설치가 됨
- Web/ftp/dns 외부 사용자들이 사용하기 위해 만들어 놓은 것이기 때문에 너무 강한 보안은 안됨
- DMS 존, Demilitarized zone : 보안이 조금 약한 부분
- 호스트들의 성격에 다라 다른 수준의 보안이 제공되어야 함
- 여러군데 두어 일의 업무량을 분산시킴

8. IDS Types
- cryptro jacking : 남의 컴퓨터 파워를 훔쳐서 자신의 암호 화폐 채굴을 이용하는 공격
- signature-base 시스템 : 다양한 네트워크 어태게 대한 정보를 두는 것
    - 공격에 대한 정보를 DB에 넣어두고 이를 비교함
    - 데이터베이스 시그니쳐와 일치하면 공격
    - 정확성은 높지만, 미리 데이터베이스화 되어있지 않은 네트워크 공격은 찾을 수 없다.

- anomaly-based 시스템 : 스스로 트래픽을 관찰해서 트래픽의 프로파일을 만들어 놓음
    - 패킷 스트림이 이상한 형태를 갖는 것을 스스로 판단하는 것
    - 진짜 일반적인 트래픽인지 공격의 일종인지 판단하는 것은 굉장히 어려움
    - 딥러닝 기술을 이용하여 이런 연구들을 많이 하려고함
